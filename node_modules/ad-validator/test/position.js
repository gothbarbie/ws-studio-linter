const assert = require( 'assert' );
const Pos = require( '../lib/position.js' );

module.exports = function () {
	describe( 'add', function () {
		it( 'adds columns and indicies', function () {
			const pos = {
				index: 2,
				line: 0,
				column: 2,
			};

			assert.deepEqual( Pos.add( pos, pos ), {
				index: 4,
				line: 0,
				column: 4,
			});
		});

		it( 'uses the second column value if the second line is zero', function () {
			const p1 = {
				index: 3,
				line: 2,
				column: 1,
			};

			const p2 = {
				index: 3,
				line: 2,
				column: 1,
			};

			assert.deepEqual( Pos.add( p1, p2 ), {
				index: 6,
				line: 4,
				column: 1,
			});
		});
	});

	describe( 'move', function () {
		it( 'moves a number of columns forward, if given a number', function () {
			const pos = {
				index: 5,
				line: 3,
				column: 2,
			};

			assert.deepEqual( Pos.move( pos, 4 ), {
				index: 9,
				line: 3,
				column: 6,
			});
		});

		it( 'moves the column forward, if given a single-line string', function () {
			const pos = {
				index: 72,
				line: 2,
				column: 53,
			};

			assert.deepEqual( Pos.move( pos, 'foobar' ), {
				index: 72 + 6,
				line: 2,
				column: 53 + 6,
			});
		});

		it( 'moves a position forward, if given a string with line-breaks', function () {
			const pos = {
				index: 16,
				line: 5,
				column: 2,
			};

			assert.deepEqual( Pos.move( pos, 'foo\nbar\nbax' ), {
				index: 16 + 11,
				line: 5 + 2,
				column: 3,
			});
		});
	});
};
